library(generalCorr)
# For dependence

gmcxy_np(A,Am)

cor.test(Ab, Ac,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Aa, Ab,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Aa, Ac,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Ca, Cb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Cb, Cc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ca, Cc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Da, Db,alternative = "two.sided", method = "pearson", exact=FALSE )
 
cor.test(Db, Dc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Da, Dc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Ea, Eb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Eb, Ec,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ea, Ec,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Fa, Fb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Fb, Fc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Fa, Fc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Ga, Gb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Gb, Gc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ga, Gc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Ha, Hb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Hb, Hc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ha, Hc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Ia, Ib,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ib, Ic,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ia, Ic,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Ka, Kb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Kb, Kc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ka, Kc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(La, Lb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Lb, Lc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(La, Lc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Ma, Mb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Mb, Mc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ma, Mc,alternative = "two.sided", method = "pearson", exact=FALSE )


cor.test(Na, Nb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Nb, Nc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Na, Nc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Pa, Pb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Pb, Pc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Pa, Pc,alternative = "two.sided", method = "pearson", exact=FALSE )


cor.test(Qa, Qb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Qb, Qc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Qa, Qc,alternative = "two.sided", method = "pearson", exact=FALSE )


cor.test(Ra, Rb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Rb, Rc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ra, Rb,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Sa, Sb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Sb, Sc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Sa, Sc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Ta, Tb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Tb, Tc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ta, Tc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Va, Vb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Vb, Vc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Va, Vc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Wa, Wb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Wb, Wc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Wa, Wc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Ya, Yb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Yb, Yc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ya, Yc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(CSa, CSb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(CSb, CSc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(CSa, CSc,alternative = "two.sided", method = "pearson", exact=FALSE )

gmcxy_np(CS,CSm)

library(ppcor)
pcor.test(Aa, Ab, Ac)
pcor.test(Ab, Ac, Aa)
pcor.test(Aa, Ac, Ab)
pcor.test(Ca, Cb, Cc)
pcor.test(Cb, Cc, Ca)
pcor.test(Ca, Cc, Cb)
pcor.test(Da, Db, Dc)
pcor.test(Db, Dc, Da)
pcor.test(Da, Dc, Db)
pcor.test(Ea, Eb, Ec)
pcor.test(Eb, Ec, Ea)
pcor.test(Ea, Ec, Eb)
pcor.test(Fa, Fb, Fc)
pcor.test(Fb, Fc, Fa)
pcor.test(Fa, Fc, Fb)
pcor.test(Ga, Gb, Gc)
pcor.test(Gb, Gc, Ga)
pcor.test(Ga, Gc, Gb)
pcor.test(Ha, Hb, Hc)
pcor.test(Hb, Hc, Ha)
pcor.test(Ha, Hc, Hb)
pcor.test(Ia, Ib, Ic)
pcor.test(Ib, Ic, Ia)
pcor.test(Ia, Ic, Ib)
pcor.test(Ka, Kb, Kc)
pcor.test(Kb, Kc, Ka)
pcor.test(Ka, Kc, Kb)
pcor.test(La, Lb, Lc)
pcor.test(Lb, Lc, La)
pcor.test(La, Lc, Lb)
pcor.test(Ma, Mb, Mc)
pcor.test(Mb, Mc, Ma)
pcor.test(Ma, Mc, Mb)
pcor.test(Na, Nb, Nc)
pcor.test(Nb, Nc, Na)
pcor.test(Na, Nc, Nb)
pcor.test(Pa, Pb, Pc)
pcor.test(Pb, Pc, Pa)
pcor.test(Pa, Pc, Pb)
pcor.test(Qa, Qb, Qc)
pcor.test(Qb, Qc, Qa)
pcor.test(Qa, Qc, Qb)
pcor.test(Ra, Rb, Rc)
pcor.test(Rb, Rc, Ra)
pcor.test(Ra, Rc, Rb)
pcor.test(Sa, Sb, Sc)
pcor.test(Sb, Sc, Sa)
pcor.test(Sa, Sc, Sb)
pcor.test(Ta, Tb, Tc)
pcor.test(Tb, Tc, Ta)
pcor.test(Ta, Tc, Tb)
pcor.test(Va, Vb, Vc)
pcor.test(Vb, Vc, Va)
pcor.test(Va, Vc, Vb)
pcor.test(Wa, Wb, Wc)
pcor.test(Wb, Wc, Wa)
pcor.test(Wa, Wc, Wb)
pcor.test(Ya, Yb, Yc)
pcor.test(Yb, Yc, Ya)
pcor.test(Ya, Yc, Yb)
pcor.test(CSa, CSb, CSc)
pcor.test(CSb, CSc, CSa)
pcor.test(CSa, CSc, CSb)

pcor.test(V, T, A)
pcor.test(F, Y, CS)
pcor.test(I, V, CS)
pcor.test(N, S, CS)
pcor.test(R, K, CS)
pcor.test(R, Q, CS)
pcor.test(G, S, CS)
pcor.test(D, G, CS)
pcor.test(S, N, CS)

cor.test(Ab, Kb,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Ca, Cb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Cb, Cc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ca, Cc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Da, Db,alternative = "two.sided", method = "pearson", exact=FALSE )
 
cor.test(Db, Dc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Da, Dc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Ea, Eb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Eb, Ec,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ea, Ec,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Fa, Fb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Fb, Fc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Fa, Fc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Ga, Gb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Gb, Gc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ga, Gc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Ha, Hb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Hb, Hc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ha, Hc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Ia, Ib,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ib, Ic,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ia, Ic,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Ka, Kb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Kb, Kc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ka, Kc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(La, Lb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Lb, Lc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(La, Lc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Ma, Mb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Mb, Mc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ma, Mc,alternative = "two.sided", method = "pearson", exact=FALSE )


cor.test(Na, Nb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Nb, Nc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Na, Nc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Pa, Pb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Pb, Pc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Pa, Pc,alternative = "two.sided", method = "pearson", exact=FALSE )


cor.test(Qa, Qb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Qb, Qc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Qa, Qc,alternative = "two.sided", method = "pearson", exact=FALSE )


cor.test(Ra, Rb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Rb, Rc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ra, Rb,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Sa, Sb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Sb, Sc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Sa, Sc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Ta, Tb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Tb, Tc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ta, Tc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Va, Vb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Vb, Vc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Va, Vc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Wa, Wb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Wb, Wc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Wa, Wc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(Ya, Yb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Yb, Yc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(Ya, Yc,alternative = "two.sided", method = "pearson", exact=FALSE )

cor.test(CSa, CSb,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(CSb, CSc,alternative = "two.sided", method = "pearson", exact=FALSE )
cor.test(CSa, CSc,alternative = "two.sided", method = "pearson", exact=FALSE )
library(tidyverse)

# Create dataframe with your data
df <- tibble(
  AminoAcid = c("A","C","D","E","F","G","H","I","K","L","M",
                "N","P","Q","R","S","T","V","W","Y"),
  JAM1 = c(6.701111,1.982282,4.611532,5.083875,4.493732,7.809732,
           0.8029643,3.528811,6.543164,7.575671,1.463554,4.123754,
           5.861261,3.050975,4.618611,9.878421,7.370021,9.235204,
           1.118132,4.113954),
  JAM2 = c(6.326357,2.965971,4.580646,5.743893,4.03835,6.470732,
           1.701296,4.613639,6.837171,8.175796,1.568396,4.347925,
           4.760771,3.085718,6.035421,8.663514,6.09425,9.162943,
           1.008157,3.816743),
  JAM3 = c(6.101982,2.800354,4.8851,6.292693,4.39375,6.736382,
           1.291721,5.087182,6.305629,7.985775,1.174964,4.56065,
           4.787025,3.157486,6.058114,8.004843,5.923786,9.237518,
           1.043461,4.169214)
) %>%
pivot_longer(cols=c(JAM1,JAM2,JAM3),names_to="Protein",values_to="MeanConservation") %>%
mutate(pI=case_when(
  Protein=="JAM1"~8.09,
  Protein=="JAM2"~9.23,
  Protein=="JAM3"~7.53
))
# Check amino acids individually:
df %>%
  group_by(AminoAcid) %>%
  summarize(correlation=cor(pI, MeanConservation)) %>%
  arrange(desc(abs(correlation)))




